<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê´€ë¦¬ì ëª¨ë“œ</title>
</head>
<body>
    <h1>ğŸ” ê´€ë¦¬ì ëª¨ë“œ</h1>

    {% if not admin_logged_in %}
    <form method="POST">
        <label>ë¹„ë°€ë²ˆí˜¸ ì…ë ¥:
            <input type="password" name="password" required>
        </label>
        <button type="submit">ë¡œê·¸ì¸</button>
    </form>
    <p style="color:red;">{{ message }}</p>
    {% else %}
    <hr>
    
    <h2>ğŸ› ï¸ ìˆ˜ë™ ì‹œê°„ ìŠ¬ë¡¯ ì˜¤í”ˆ</h2>
    <form method="POST" action="/admin">
      <input type="hidden" name="action" value="manual_open">
      <label for="slot_time">ì‹œê°„ ì„ íƒ:</label>
      <select name="slot_time" id="slot_time">
        {% for slot in time_slots %}
          <option value="{{ slot.time }}">{{ slot.time }}</option>
        {% endfor %}
      </select>
      <button type="submit">ìˆ˜ë™ ì˜¤í”ˆ</button>
    </form>

    {% if manual_open_slots %}
      <h2>ğŸ”’ ìˆ˜ë™ ì˜¤í”ˆëœ ì‹œê°„ë“¤</h2>
      <ul>
        {% for slot in manual_open_slots %}
          <li>
            {{ slot }}
            <form method="POST" action="/admin" style="display:inline;">
              <input type="hidden" name="action" value="manual_close">
              <input type="hidden" name="slot_time" value="{{ slot }}">
              <button type="submit">ë‹«ê¸°</button>
            </form>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>âŒ í˜„ì¬ ìˆ˜ë™ ì˜¤í”ˆëœ ìŠ¬ë¡¯ ì—†ìŒ</p>
    {% endif %}

    <hr>
    <h2>â›” ìë™ ì˜¤í”ˆ ì‹œê°„ ì¤‘ ë‹«ê³  ì‹¶ì€ ì‹œê°„</h2>
    <form method="POST" action="/admin">
      <input type="hidden" name="action" value="manual_force_close">
      <label for="slot_time">ì‹œê°„ ì„ íƒ:</label>
      <select name="slot_time" id="slot_time">
        {% for slot in time_slots %}
          {% if slot.time not in manual_open_slots %}
            <option value="{{ slot.time }}">{{ slot.time }}</option>
          {% endif %}
        {% endfor %}
      </select>
      <button type="submit">ìë™ ì˜¤í”ˆ ì‹œê°„ ë‹«ê¸°</button>
    </form>

    <hr>
    <h2>â›” ìˆ˜ë™ìœ¼ë¡œ ë‹«ì„ ì‹œê°„ ì„¤ì •</h2>
    <form method="POST" action="/admin">
      <input type="hidden" name="action" value="manual_force_close">
      <label for="slot_time">ì‹œê°„ ì„ íƒ:</label>
      <select name="slot_time" id="slot_time">
        {% for slot in time_slots %}
          {% if slot.time not in manual_open_slots and slot.time not in manual_close_slots %}
            <option value="{{ slot.time }}">{{ slot.time }}</option>
          {% endif %}
        {% endfor %}
      </select>
      <button type="submit">ì‹œê°„ ë‹«ê¸°</button>
    </form>
    
    {% if manual_close_slots %}
      <h3>â›” ê°•ì œë¡œ ë‹«ì€ ì‹œê°„ ëª©ë¡</h3>
      <ul>
        {% for slot in manual_close_slots %}
          <li>
            {{ slot }}
            <form method="POST" action="/admin" style="display:inline;">
              <input type="hidden" name="action" value="cancel_manual_close">
              <input type="hidden" name="slot_time" value="{{ slot }}">
              <button type="submit">ì·¨ì†Œ</button>
            </form>
          </li>
        {% endfor %}
      </ul>
    {% endif %}

    <hr>
    <h2>ì˜ˆì•½ì ì‚­ì œ</h2>
    <form method="POST">
        <input type="hidden" name="action" value="delete">
        <label>ì‹œê°„ ì„ íƒ:
            <select name="time">
                {% for slot in time_slots %}
                    <option value="{{ slot.time }}">{{ slot.time }}</option>
                {% endfor %}
            </select>
        </label>
        <label>ì´ë¦„:
            <input type="text" name="name" required>
        </label>
        <button type="submit">ì‚­ì œ</button>
    </form>

    <h2>ì˜ˆì•½ì ê²€ìƒ‰</h2>
    <form method="POST">
        <input type="hidden" name="action" value="search">
        <input type="text" name="keyword" placeholder="ì´ë¦„ ê²€ìƒ‰">
        <button type="submit">ê²€ìƒ‰</button>
    </form>

    <hr>
    <h2>ì˜ˆì•½ í˜„í™©</h2>
    <ul>
        {% for time, people in reservations.items() %}
            <li><strong>{{ time }}</strong>:
                {% for p in people %}
                    {{ p }}{% if not loop.last %}, {% endif %}
                {% endfor %}
            </li>
        {% endfor %}
    </ul>

    <h2 style="margin-top: 30px;">ì „ì²´ ì´ˆê¸°í™”</h2>
    <form method="POST" onsubmit="return confirm('ì •ë§ ì „ì²´ ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
        <input type="hidden" name="action" value="reset">
        <button type="submit" style="color:red;">âš ï¸ ì „ì²´ ì˜ˆì•½ ì´ˆê¸°í™”</button>
    </form>

    {% endif %}
</body>
</html>
